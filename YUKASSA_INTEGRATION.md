# üí≥ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ÆKassa

–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ÆKassa.

## üéØ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤–æ
- ‚úÖ **–ö–ª–∏–µ–Ω—Ç –ÆKassa API** —Å –ø–æ–ª–Ω–æ–π –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ **–°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π** —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –≤—ã—Å—Ç–∞–≤–ª–µ–Ω–∏–µ–º —Å—á–µ—Ç–æ–≤
- ‚úÖ **Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞** —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π HMAC –ø–æ–¥–ø–∏—Å–∏
- ‚úÖ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤** –≤ –ú–æ–π–°–∫–ª–∞–¥ –ø—Ä–∏ –æ–ø–ª–∞—Ç–µ
- ‚úÖ **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫** –≤ AmoCRM –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å—Ç–∞—Ç—É—Å–∞
- ‚úÖ **–§–∏—Å–∫–∞–ª–∏–∑–∞—Ü–∏—è —á–µ–∫–æ–≤** –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å 54-–§–ó
- ‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ò–ò –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º** –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–æ—Å—Ç–∞–≤–∫–∏** –≤ —Å–æ—Å—Ç–∞–≤–µ –ø–ª–∞—Ç–µ–∂–∞
- ‚úÖ **–ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
src/payments/
‚îú‚îÄ‚îÄ __init__.py
‚îú‚îÄ‚îÄ yukassa_client.py        # –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∏–µ–Ω—Ç –ÆKassa
‚îî‚îÄ‚îÄ webhook_handler.py       # –û–±—Ä–∞–±–æ—Ç—á–∏–∫ webhooks

src/catalog/
‚îî‚îÄ‚îÄ product_manager.py       # –ú–µ—Ç–æ–¥—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏ (–¥–æ–±–∞–≤–ª–µ–Ω—ã)

src/integrations/
‚îú‚îÄ‚îÄ moysklad_client.py       # –ú–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤ (–¥–æ–±–∞–≤–ª–µ–Ω—ã)  
‚îî‚îÄ‚îÄ amocrm_client.py         # –£–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–æ–∫

src/ai/
‚îî‚îÄ‚îÄ consultant.py            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ–ø–ª–∞—Ç—É (–¥–æ–±–∞–≤–ª–µ–Ω–∞)

tests/
‚îî‚îÄ‚îÄ test_yukassa_payments.py # –ö–æ–º–ø–ª–µ–∫—Å–Ω—ã–µ —Ç–µ—Å—Ç—ã —Å–∏—Å—Ç–µ–º—ã
```

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π

```python
# –ß–µ—Ä–µ–∑ ProductManager
order_result = await product_manager.create_order_with_payment(
    customer_data={
        "name": "–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤",
        "phone": "+7 900 123 45 67", 
        "email": "customer@example.com"
    },
    products=[{
        "name": "–ö–æ–ª—å—Ü–æ —Å —è–Ω—Ç–∞—Ä–µ–º",
        "price": 2500,
        "quantity": 1
    }],
    telegram_user_id=12345,
    delivery_info={
        "cost": 200,
        "service_name": "–ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏"
    }
)

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç payment_url –¥–ª—è –æ–ø–ª–∞—Ç—ã
```

### 2. –û–±—Ä–∞–±–æ—Ç–∫–∞ webhooks

```python
# FastAPI endpoint –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è
from src.payments.webhook_handler import setup_webhook_routes

app = FastAPI()
setup_webhook_routes(app)

# Webhook –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: POST /webhooks/yukassa
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –≤ —á–∞—Ç–µ

```python
# –ò–ò –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–µ—Ç:
"–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å –∫–æ–ª—å—Ü–æ"           # ‚Üí –°–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑ –∏ –ø–ª–∞—Ç–µ–∂
"–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑ –Ω–∞ 101000"       # ‚Üí –° —É—á–µ—Ç–æ–º –¥–æ—Å—Ç–∞–≤–∫–∏
"–ö—É–ø–∏—Ç—å –±—Ä–∞—Å–ª–µ—Ç"                 # ‚Üí –î–µ–º–æ —Ç–æ–≤–∞—Ä —Å –æ–ø–ª–∞—Ç–æ–π
```

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
YUKASSA_SHOP_ID=your_shop_id
YUKASSA_SECRET_KEY=your_secret_key
YUKASSA_WEBHOOK_SECRET=your_webhook_secret

# –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ:
YUKASSA_TEST_MODE=true                    # –¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
YUKASSA_TAX_SYSTEM=1                      # 1=–û–°–ù, 2=–£–°–ù –¥–æ—Ö–æ–¥—ã, –∏ —Ç.–¥.
YUKASSA_VAT_CODE=2                        # 1=–±–µ–∑ –ù–î–°, 2=–ù–î–° 20%, –∏ —Ç.–¥.
YUKASSA_SEND_RECEIPT=true                 # –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å —á–µ–∫–∏ (54-–§–ó)
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–ª—é—á–µ–π –ÆKassa

1. **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –º–∞–≥–∞–∑–∏–Ω–∞**: https://yookassa.ru/merchants/
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ shop_id**: –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ ‚Üí –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –î–∞–Ω–Ω—ã–µ –º–∞–≥–∞–∑–∏–Ω–∞
3. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è secret_key**: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí API ‚Üí –°–æ–∑–¥–∞—Ç—å –∫–ª—é—á
4. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook**: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí Webhook ‚Üí –î–æ–±–∞–≤–∏—Ç—å URL

## üìä –ü—Ä–æ—Ü–µ—Å—Å –æ–ø–ª–∞—Ç—ã

### 1. –ö–ª–∏–µ–Ω—Ç –æ—Ñ–æ—Ä–º–ª—è–µ—Ç –∑–∞–∫–∞–∑
```
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–•–æ—á—É –∑–∞–∫–∞–∑–∞—Ç—å –∫–æ–ª—å—Ü–æ"
–ö–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç: –°–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑ –≤ –ú–æ–π–°–∫–ª–∞–¥ ‚Üí –°–æ–∑–¥–∞–µ—Ç –ø–ª–∞—Ç–µ–∂ –≤ –ÆKassa ‚Üí –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Å—ã–ª–∫—É
```

### 2. –û–ø–ª–∞—Ç–∞
```
–ö–ª–∏–µ–Ω—Ç –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ ‚Üí –í—ã–±–∏—Ä–∞–µ—Ç —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã ‚Üí –û–ø–ª–∞—á–∏–≤–∞–µ—Ç
```

### 3. Webhook –æ–±—Ä–∞–±–æ—Ç–∫–∞
```
–ÆKassa –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook ‚Üí –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –≤ –ú–æ–π–°–∫–ª–∞–¥ ‚Üí –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–¥–µ–ª–∫–∏ –≤ AmoCRM
```

## üîß –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–∞—Ä—Ç—ã –ÆKassa:

| –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –ù–æ–º–µ—Ä –∫–∞—Ä—Ç—ã | –°—Ä–æ–∫ | CVC |
|------------|-------------|------|-----|
| –£—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂ | `5555555555554444` | `12/24` | `123` |
| –ù–µ—É—Å–ø–µ—à–Ω—ã–π –ø–ª–∞—Ç–µ–∂ | `5555555555554477` | `12/24` | `123` |
| –ü–ª–∞—Ç–µ–∂ —Å 3-D Secure | `5555555555554495` | `12/24` | `123` |

## üìã –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Å–ø–æ—Å–æ–±—ã –æ–ø–ª–∞—Ç—ã

- üí≥ **–ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã** (Visa, Mastercard, –ú–ò–†)
- üè¶ **–°–ë–ü** (–°–∏—Å—Ç–µ–º–∞ –±—ã—Å—Ç—Ä—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π)
- üí∞ **–≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–µ –∫–æ—à–µ–ª—å–∫–∏** (–ÆMoney, Qiwi)
- üè™ **–°–±–µ—Ä–±–∞–Ω–∫ –û–Ω–ª–∞–π–Ω**
- üì± **Apple Pay / Google Pay**

## üßæ –§–∏—Å–∫–∞–ª–∏–∑–∞—Ü–∏—è (54-–§–ó)

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç —á–µ–∫–∏:

```json
{
  "customer": {"email": "user@example.com"},
  "items": [
    {
      "description": "–ö–æ–ª—å—Ü–æ —Å —è–Ω—Ç–∞—Ä–µ–º",
      "quantity": "1",
      "amount": {"value": "2500.00", "currency": "RUB"},
      "vat_code": 2,
      "payment_mode": "full_payment",
      "payment_subject": "commodity"
    },
    {
      "description": "–î–æ—Å—Ç–∞–≤–∫–∞ - –ü–æ—á—Ç–∞ –†–æ—Å—Å–∏–∏",
      "quantity": "1", 
      "amount": {"value": "200.00", "currency": "RUB"},
      "vat_code": 2,
      "payment_mode": "full_payment",
      "payment_subject": "service"
    }
  ],
  "tax_system_code": 1
}
```

## üîÑ –°—Ç–∞—Ç—É—Å—ã –ø–ª–∞—Ç–µ–∂–µ–π –∏ –¥–µ–π—Å—Ç–≤–∏—è

| –°—Ç–∞—Ç—É—Å –ÆKassa | –î–µ–π—Å—Ç–≤–∏–µ –≤ –ú–æ–π–°–∫–ª–∞–¥ | –î–µ–π—Å—Ç–≤–∏–µ –≤ AmoCRM |
|---------------|-------------------|-----------------|
| `payment.succeeded` | –ó–∞–∫–∞–∑ ‚Üí "–û–ø–ª–∞—á–µ–Ω" | –°–¥–µ–ª–∫–∞ ‚Üí –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ–± –æ–ø–ª–∞—Ç–µ |
| `payment.canceled` | –ó–∞–∫–∞–∑ ‚Üí "–û—Ç–º–µ–Ω–µ–Ω" | –°–¥–µ–ª–∫–∞ ‚Üí –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ–± –æ—Ç–º–µ–Ω–µ |
| `payment.waiting_for_capture` | –ó–∞–∫–∞–∑ ‚Üí "–û–∂–∏–¥–∞–µ—Ç –æ–ø–ª–∞—Ç—ã" | –°–¥–µ–ª–∫–∞ ‚Üí –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ –æ–± –æ–∂–∏–¥–∞–Ω–∏–∏ |

## üõ† –ó–∞–ø—É—Å–∫ –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

```bash
python3 tests/test_yukassa_payments.py
```

### –ó–∞–ø—É—Å–∫ webhook —Å–µ—Ä–≤–µ—Ä–∞

```bash
python3 src/payments/webhook_handler.py
```

Webhook –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É: `http://localhost:8000/webhooks/yukassa`

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ production

1. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ ngrok –∏–ª–∏ –∞–Ω–∞–ª–æ–≥–∏—á–Ω—ã–π —Ç—É–Ω–Ω–µ–ª—å:
   ```bash
   ngrok http 8000
   ```

2. –£–∫–∞–∂–∏—Ç–µ webhook URL –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ÆKassa:
   ```
   https://your-tunnel.ngrok.io/webhooks/yukassa
   ```

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è:

- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ –ü–æ–ª—É—á–µ–Ω–∏–µ webhooks  
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤
- ‚úÖ –û—à–∏–±–∫–∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

–õ–æ–≥–∏ –¥–æ—Å—Ç—É–ø–Ω—ã —á–µ—Ä–µ–∑ `app_logger`:

```python
from utils.logger import app_logger

# –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤:
[INFO] –ü–ª–∞—Ç–µ–∂ —Å–æ–∑–¥–∞–Ω: 24e89cb0-000f-5000-8000-18db351245c7, —Å—É–º–º–∞: 2700‚ÇΩ
[INFO] Webhook –ø–æ–ª—É—á–µ–Ω: payment.succeeded, –ø–ª–∞—Ç–µ–∂: 24e89cb0-000f-5000-8000-18db351245c7
[INFO] –ó–∞–∫–∞–∑ ORDER_123 –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –æ–ø–ª–∞—á–µ–Ω–Ω—ã–π –≤ –ú–æ–π–°–∫–ª–∞–¥
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ webhook** —á–µ—Ä–µ–∑ HMAC SHA256
- ‚úÖ **HTTPS –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω** –¥–ª—è webhook endpoint
- ‚úÖ **–°–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏** –¥–æ–ª–∂–Ω—ã —Ö—Ä–∞–Ω–∏—Ç—å—Å—è –≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ **–ò–¥–µ–º–ø–æ—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å –ø–ª–∞—Ç–µ–∂–µ–π** —á–µ—Ä–µ–∑ Idempotence-Key

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

- ‚ö†Ô∏è **–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º** –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (—Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è)
- ‚ö†Ô∏è **Demo —Ç–æ–≤–∞—Ä—ã** –≤ –∑–∞–∫–∞–∑–∞—Ö (—Ç—Ä–µ–±—É–µ—Ç –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –∫–æ—Ä–∑–∏–Ω–æ–π)
- ‚ö†Ô∏è **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç–∞** (—Ç—Ä–µ–±—É–µ—Ç —Ñ–æ—Ä–º—ã –≤–≤–æ–¥–∞)

### Production Checklist

- [ ] –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ API –∫–ª—é—á–∏ –ÆKassa
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook –Ω–∞ –ø—É–±–ª–∏—á–Ω–æ–º –¥–æ–º–µ–Ω–µ —Å SSL
- [ ] –£–∫–∞–∑–∞—Ç—å webhook URL –≤ –ø–∞–Ω–µ–ª–∏ –ÆKassa
- [ ] –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –≤ –±–æ–µ–≤–æ–π —Ä–µ–∂–∏–º (`YUKASSA_TEST_MODE=false`)
- [ ] –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–∞ (–∏–º—è, —Ç–µ–ª–µ—Ñ–æ–Ω, email)
- [ ] –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å –∫–æ—Ä–∑–∏–Ω–æ–π —Ç–æ–≤–∞—Ä–æ–≤
- [ ] –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ webhook
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏

## üéâ –ì–æ—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü—Ä–æ—Å—Ç–∞—è –ø–æ–∫—É–ø–∫–∞
```
–ö–ª–∏–µ–Ω—Ç: "–•–æ—á—É –∫—É–ø–∏—Ç—å –∫–æ–ª—å—Ü–æ"
–°–∏—Å—Ç–µ–º–∞: –°–æ–∑–¥–∞–µ—Ç –∑–∞–∫–∞–∑ ‚Üí –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å—Å—ã–ª–∫—É –æ–ø–ª–∞—Ç—ã ‚Üí –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∫–ª–∏–µ–Ω—Ç—É
–ö–ª–∏–µ–Ω—Ç: –ü–µ—Ä–µ—Ö–æ–¥–∏—Ç –ø–æ —Å—Å—ã–ª–∫–µ ‚Üí –û–ø–ª–∞—á–∏–≤–∞–µ—Ç
–°–∏—Å—Ç–µ–º–∞: –ü–æ–ª—É—á–∞–µ—Ç webhook ‚Üí –û–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å—ã ‚Üí –£–≤–µ–¥–æ–º–ª—è–µ—Ç –º–µ–Ω–µ–¥–∂–µ—Ä–∞
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–æ–∫—É–ø–∫–∞ —Å –¥–æ—Å—Ç–∞–≤–∫–æ–π  
```
–ö–ª–∏–µ–Ω—Ç: "–ó–∞–∫–∞–∑–∞—Ç—å –Ω–∞ 101000"
–°–∏—Å—Ç–µ–º–∞: –†–∞—Å–ø–æ–∑–Ω–∞–µ—Ç –∏–Ω–¥–µ–∫—Å ‚Üí –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ—Å—Ç–∞–≤–∫—É ‚Üí –í–∫–ª—é—á–∞–µ—Ç –≤ –∑–∞–∫–∞–∑ ‚Üí –°–æ–∑–¥–∞–µ—Ç –ø–ª–∞—Ç–µ–∂
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –û—Ç–º–µ–Ω–∞ –ø–ª–∞—Ç–µ–∂–∞
```
–ö–ª–∏–µ–Ω—Ç: –ù–µ –∑–∞–≤–µ—Ä—à–∞–µ—Ç –æ–ø–ª–∞—Ç—É / –æ—Ç–º–µ–Ω—è–µ—Ç
–ÆKassa: –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç webhook payment.canceled
–°–∏—Å—Ç–µ–º–∞: –ü–æ–º–µ—á–∞–µ—Ç –∑–∞–∫–∞–∑ –∫–∞–∫ –æ—Ç–º–µ–Ω–µ–Ω–Ω—ã–π
```

---

**üéØ –°–∏—Å—Ç–µ–º–∞ –ÆKassa –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

–î–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ API –∫–ª—é—á–∏ –∏ webhook endpoint.